---
title: "Kotlinåç¨‹å¼‚å¸¸å¤„ç†æœºåˆ¶è¯¦è§£"
date: 2026-02-14 08:00:00
categories: ["Kotlin","Kotlinåç¨‹"]
tags: ["Kotlinåç¨‹","å¼‚å¸¸å¤„ç†æœºåˆ¶","å¼‚å¸¸ä¼ æ’­","try-catch","CoroutineExceptionHandler","SupervisorJob"]
---

# ğŸš€Kotlin åç¨‹å¼‚å¸¸å¤„ç†æœºåˆ¶è¯¦è§£

æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æ­£åœ¨è¿›è¡Œä¸€åœºæ¥åŠ›æ¯”èµ›ï¼Œæ¯ä¸ªè¿åŠ¨å‘˜ä»£è¡¨ä¸€ä¸ªåç¨‹ã€‚åœ¨æ¯”èµ›è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šæœ‰è¿åŠ¨å‘˜æ‘”å€’ï¼ˆå‡ºç°å¼‚å¸¸ï¼‰ï¼Œè¿™æ—¶å€™å°±éœ€è¦æœ‰ä¸€å¥—æœºåˆ¶æ¥å¤„ç†è¿™ç§çªå‘æƒ…å†µï¼Œä¿è¯æ•´ä¸ªæ¯”èµ›èƒ½å¤Ÿé¡ºåˆ©è¿›è¡Œæˆ–è€…æœ‰åºç»“æŸã€‚åœ¨ Kotlin åç¨‹é‡Œï¼Œå¼‚å¸¸å¤„ç†æœºåˆ¶å°±æ‰®æ¼”ç€è¿™æ ·çš„è§’è‰²ã€‚è¿™ç¯‡æ–‡ç« å°†å¸¦ä½ ä»å¤´åˆ°å°¾å­¦ä¼š Kotlin åç¨‹çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ã€‚

## åç¨‹å¼‚å¸¸çš„åŸºæœ¬æ¦‚å¿µ
### å¼‚å¸¸çš„äº§ç”Ÿ
åœ¨åç¨‹ä¸­ï¼Œå½“ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°é”™è¯¯æ—¶ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚å°±åƒæ¥åŠ›æ¯”èµ›ä¸­è¿åŠ¨å‘˜è¢«ç»Šå€’ä¸€æ ·ï¼Œä»£ç å¯èƒ½å› ä¸ºå„ç§åŸå› ï¼ˆå¦‚ç½‘ç»œè¯·æ±‚å¤±è´¥ã€ç©ºæŒ‡é’ˆç­‰ï¼‰æŠ›å‡ºå¼‚å¸¸ã€‚

### å¼‚å¸¸çš„ä¼ æ’­
åç¨‹ä¸­çš„å¼‚å¸¸ä¼ æ’­æœ‰ä¸¤ç§ä¸»è¦æ–¹å¼ï¼š
- **çˆ¶å­åç¨‹ä¹‹é—´**ï¼šå­åç¨‹æŠ›å‡ºçš„å¼‚å¸¸é»˜è®¤ä¼šä¼ æ’­ç»™çˆ¶åç¨‹ã€‚å¯ä»¥æŠŠçˆ¶åç¨‹æƒ³è±¡æˆæ¥åŠ›æ¯”èµ›çš„é˜Ÿé•¿ï¼Œå­åç¨‹æ˜¯é˜Ÿå‘˜ï¼Œé˜Ÿå‘˜å‡ºé—®é¢˜äº†ä¼šå‘Šè¯‰é˜Ÿé•¿ã€‚
- **åç¨‹ä½œç”¨åŸŸå†…**ï¼šå¼‚å¸¸ä¼šåœ¨åç¨‹ä½œç”¨åŸŸå†…ä¼ æ’­ï¼Œç›´åˆ°è¢«å¤„ç†æˆ–è€…å¯¼è‡´æ•´ä¸ªä½œç”¨åŸŸå´©æºƒã€‚

### é”™è¯¯å¸¸è§ä¸è§£å†³åŠæ³•
#### é”™è¯¯ï¼šå­åç¨‹å¼‚å¸¸å¯¼è‡´çˆ¶åç¨‹å´©æºƒ
å½“å­åç¨‹æŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œå¦‚æœæ²¡æœ‰å¤„ç†ï¼Œçˆ¶åç¨‹ä¹Ÿä¼šå´©æºƒã€‚
**è§£å†³åŠæ³•**ï¼šä½¿ç”¨ `SupervisorJob` æ¥åˆ›å»ºåç¨‹ä½œç”¨åŸŸï¼Œå®ƒå¯ä»¥è®©å­åç¨‹çš„å¼‚å¸¸ä¸ä¼šå½±å“åˆ°çˆ¶åç¨‹ã€‚

#### é”™è¯¯ï¼šå…¨å±€å¼‚å¸¸æœªæ•è·
å¦‚æœæ²¡æœ‰è®¾ç½®å…¨å±€å¼‚å¸¸å¤„ç†å™¨ï¼Œä¸€äº›æœªå¤„ç†çš„å¼‚å¸¸å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒã€‚
**è§£å†³åŠæ³•**ï¼šè®¾ç½®å…¨å±€çš„ `CoroutineExceptionHandler` æ¥æ•è·è¿™äº›å¼‚å¸¸ã€‚

## å¼‚å¸¸å¤„ç†çš„æ–¹å¼

### try-catch å—
è¿™æ˜¯æœ€åŸºæœ¬çš„å¼‚å¸¸å¤„ç†æ–¹å¼ï¼Œå°±åƒç»™è¿åŠ¨å‘˜å‡†å¤‡äº†ä¸€ä¸ªæ€¥æ•‘åŒ…ï¼Œå½“å‡ºç°å°é—®é¢˜æ—¶å¯ä»¥åŠæ—¶å¤„ç†ã€‚

```kotlin
import kotlinx.coroutines.*

fun main() = runBlocking {
    // åˆ›å»ºä¸€ä¸ªåç¨‹
    val job = launch {
        try {
            // æ¨¡æ‹Ÿå¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„ä»£ç 
            throw RuntimeException("Oops! Something went wrong.")
        } catch (e: Exception) {
            // æ•è·å¹¶å¤„ç†å¼‚å¸¸
            println("Caught exception: ${e.message}")
        }
    }
    // ç­‰å¾…åç¨‹æ‰§è¡Œå®Œæ¯•
    job.join()
}
```
**ä»£ç è§£é‡Š**ï¼š
- `launch` å‡½æ•°ç”¨äºå¯åŠ¨ä¸€ä¸ªåç¨‹ã€‚
- `try` å—ä¸­åŒ…å«å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„ä»£ç ï¼Œè¿™é‡Œä½¿ç”¨ `throw` å…³é”®å­—æ‰‹åŠ¨æŠ›å‡ºä¸€ä¸ª `RuntimeException`ã€‚
- `catch` å—ç”¨äºæ•è·å¹¶å¤„ç†å¼‚å¸¸ï¼Œå°†å¼‚å¸¸ä¿¡æ¯æ‰“å°å‡ºæ¥ã€‚
- `job.join()` ç”¨äºç­‰å¾…åç¨‹æ‰§è¡Œå®Œæ¯•ã€‚

### CoroutineExceptionHandler
`CoroutineExceptionHandler` å°±åƒæ¯”èµ›çš„è£åˆ¤ï¼Œä¸“é—¨è´Ÿè´£å¤„ç†æ¯”èµ›ä¸­çš„çªå‘æƒ…å†µã€‚å®ƒå¯ä»¥ç”¨æ¥æ•è·åç¨‹ä¸­çš„æœªå¤„ç†å¼‚å¸¸ã€‚

```kotlin
import kotlinx.coroutines.*

fun main() = runBlocking {
    // åˆ›å»ºä¸€ä¸ªå¼‚å¸¸å¤„ç†å™¨
    val exceptionHandler = CoroutineExceptionHandler { _, throwable ->
        // å¤„ç†å¼‚å¸¸
        println("Caught exception: ${throwable.message}")
    }
    // åˆ›å»ºä¸€ä¸ªå¸¦æœ‰å¼‚å¸¸å¤„ç†å™¨çš„åç¨‹
    val job = GlobalScope.launch(exceptionHandler) {
        // æ¨¡æ‹ŸæŠ›å‡ºå¼‚å¸¸
        throw RuntimeException("Another error occurred.")
    }
    // ç­‰å¾…åç¨‹æ‰§è¡Œå®Œæ¯•
    job.join()
}
```
**ä»£ç è§£é‡Š**ï¼š
- `CoroutineExceptionHandler` æ˜¯ä¸€ä¸ªæ¥å£ï¼Œé€šè¿‡ lambda è¡¨è¾¾å¼å®ç°ï¼Œç”¨äºå¤„ç†åç¨‹ä¸­çš„å¼‚å¸¸ã€‚
- `GlobalScope.launch(exceptionHandler)` å¯åŠ¨ä¸€ä¸ªå¸¦æœ‰å¼‚å¸¸å¤„ç†å™¨çš„åç¨‹ã€‚
- å½“åç¨‹ä¸­æŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œå¼‚å¸¸å¤„ç†å™¨ä¼šæ•è·å¹¶å¤„ç†è¯¥å¼‚å¸¸ã€‚

### SupervisorJob
`SupervisorJob` å°±åƒä¸€ä¸ªå®½å®¹çš„é˜Ÿé•¿ï¼Œå…è®¸é˜Ÿå‘˜å‡ºç°é—®é¢˜è€Œä¸å½±å“æ•´ä¸ªå›¢é˜Ÿã€‚å®ƒå¯ä»¥è®©å­åç¨‹çš„å¼‚å¸¸ä¸ä¼šä¼ æ’­åˆ°çˆ¶åç¨‹ã€‚

```kotlin
import kotlinx.coroutines.*

fun main() = runBlocking {
    // åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ SupervisorJob çš„åç¨‹ä½œç”¨åŸŸ
    val supervisorScope = CoroutineScope(SupervisorJob())
    // å¯åŠ¨ä¸€ä¸ªå­åç¨‹
    supervisorScope.launch {
        try {
            // æ¨¡æ‹ŸæŠ›å‡ºå¼‚å¸¸
            throw RuntimeException("Child coroutine error.")
        } catch (e: Exception) {
            // å¤„ç†å­åç¨‹çš„å¼‚å¸¸
            println("Caught exception in child coroutine: ${e.message}")
        }
    }
    // çˆ¶åç¨‹å¯ä»¥ç»§ç»­æ­£å¸¸æ‰§è¡Œ
    println("Parent coroutine is still running.")
    // ç­‰å¾…åç¨‹ä½œç”¨åŸŸå†…çš„æ‰€æœ‰åç¨‹æ‰§è¡Œå®Œæ¯•
    supervisorScope.cancel()
}
```
**ä»£ç è§£é‡Š**ï¼š
- `SupervisorJob` ç”¨äºåˆ›å»ºä¸€ä¸ªåç¨‹ä½œç”¨åŸŸï¼Œè¯¥ä½œç”¨åŸŸå†…çš„å­åç¨‹å¼‚å¸¸ä¸ä¼šå½±å“çˆ¶åç¨‹ã€‚
- `supervisorScope.launch` å¯åŠ¨ä¸€ä¸ªå­åç¨‹ï¼Œåœ¨å­åç¨‹ä¸­ä½¿ç”¨ `try-catch` å—å¤„ç†å¼‚å¸¸ã€‚
- çˆ¶åç¨‹å¯ä»¥ç»§ç»­æ­£å¸¸æ‰§è¡Œï¼Œä¸å—å­åç¨‹å¼‚å¸¸çš„å½±å“ã€‚
- `supervisorScope.cancel()` ç”¨äºå–æ¶ˆåç¨‹ä½œç”¨åŸŸå†…çš„æ‰€æœ‰åç¨‹ã€‚

## å°ç»“
æœ¬èŠ‚çš„æ ¸å¿ƒå†…å®¹æ˜¯ Kotlin åç¨‹çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ã€‚æˆ‘ä»¬å­¦ä¹ äº†å¼‚å¸¸çš„äº§ç”Ÿå’Œä¼ æ’­æ–¹å¼ï¼Œä»¥åŠä¸‰ç§å¼‚å¸¸å¤„ç†æ–¹å¼ï¼š
- **try-catch å—**ï¼šç”¨äºåœ¨åç¨‹å†…éƒ¨æ•è·å’Œå¤„ç†å¼‚å¸¸ã€‚
- **CoroutineExceptionHandler**ï¼šç”¨äºæ•è·åç¨‹ä¸­çš„æœªå¤„ç†å¼‚å¸¸ã€‚
- **SupervisorJob**ï¼šç”¨äºéš”ç¦»å­åç¨‹çš„å¼‚å¸¸ï¼Œé¿å…å½±å“çˆ¶åç¨‹ã€‚

è¡¥å……èµ„æºé“¾æ¥ï¼š
- [Kotlin å®˜æ–¹åç¨‹æ–‡æ¡£](https://kotlinlang.org/docs/coroutines-guide.html)
- [Kotlin åç¨‹å®æˆ˜æ•™ç¨‹](https://www.baeldung.com/kotlin/coroutines-exception-handling)

## ä¸‹ä¸€æ­¥å»ºè®®
æ¥ä¸‹æ¥ï¼Œä½ å¯ä»¥å­¦ä¹ æ›´é«˜çº§çš„åç¨‹åº”ç”¨ï¼Œå¦‚åç¨‹çš„å¹¶å‘æ§åˆ¶ã€åç¨‹ä¸ Flow çš„ç»“åˆç­‰ã€‚å¯ä»¥å‚è€ƒä»¥ä¸‹è¿›é˜¶æ•™ç¨‹ï¼š
- [Kotlin åç¨‹å¹¶å‘æ§åˆ¶æ•™ç¨‹](https://www.geeksforgeeks.org/kotlin-coroutines-concurrency/)
- [Kotlin åç¨‹ä¸ Flow ç»“åˆæ•™ç¨‹](https://developer.android.com/kotlin/flow)